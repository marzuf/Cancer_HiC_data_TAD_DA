
# Rscript intersect_topTADs.R TCGAkich_norm_kich 15 ENCSR079VIJ_G401_40kb ENCSR401TBQ_Caki2_40kb ENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kb pipelineConsensus

# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 1 ENCSR444WCZ_A549_40kb NCI-H460_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 1 ENCSR444WCZ_A549_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 1 NCI-H460_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 1 ENCSR444WCZ_A549NCI-H460_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 1 pipelineConsensus
# 
# Rscript intersect_topTADs.R TCGAkich_norm_kich 1 ENCSR079VIJ_G401_40kb ENCSR401TBQ_Caki2_40kb ENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAkich_norm_kich 1 ENCSR079VIJ_G401_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 1 ENCSR401TBQ_Caki2_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 1 ENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 1 pipelineConsensus
# 
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 1 ENCSR312KHQ_SK-MEL-5_40kb ENCSR862OGI_RPMI-7951_40kb ENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 1 ENCSR312KHQ_SK-MEL-5_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 1 ENCSR862OGI_RPMI-7951_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 1 ENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 1 pipelineConsensus
# 
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 10 ENCSR444WCZ_A549_40kb NCI-H460_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 10 ENCSR444WCZ_A549_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 10 NCI-H460_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 10 ENCSR444WCZ_A549NCI-H460_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 10 pipelineConsensus
# 
# Rscript intersect_topTADs.R TCGAkich_norm_kich 10 ENCSR079VIJ_G401_40kb ENCSR401TBQ_Caki2_40kb ENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAkich_norm_kich 10 ENCSR079VIJ_G401_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 10 ENCSR401TBQ_Caki2_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 10 ENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 10 pipelineConsensus
# 
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 10 ENCSR312KHQ_SK-MEL-5_40kb ENCSR862OGI_RPMI-7951_40kb ENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 10 ENCSR312KHQ_SK-MEL-5_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 10 ENCSR862OGI_RPMI-7951_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 10 ENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 10 pipelineConsensus
# 
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 3 ENCSR444WCZ_A549_40kb NCI-H460_40kb ENCSR444WCZ_A549NCI-H460_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 3 ENCSR444WCZ_A549_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 3 NCI-H460_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 3 ENCSR444WCZ_A549NCI-H460_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 3 pipelineConsensus
# 
# Rscript intersect_topTADs.R TCGAkich_norm_kich 3 ENCSR079VIJ_G401_40kb ENCSR401TBQ_Caki2_40kb ENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAkich_norm_kich 3 ENCSR079VIJ_G401_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 3 ENCSR401TBQ_Caki2_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 3 ENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 3 pipelineConsensus
# 
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 3 ENCSR312KHQ_SK-MEL-5_40kb ENCSR862OGI_RPMI-7951_40kb ENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 3 ENCSR312KHQ_SK-MEL-5_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 3 ENCSR862OGI_RPMI-7951_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 3 ENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 3 pipelineConsensus
# 
# 
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 5 ENCSR444WCZ_A549_40kb NCI-H460_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 5 ENCSR444WCZ_A549_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 5 NCI-H460_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 5 ENCSR444WCZ_A549NCI-H460_40kb
# Rscript intersect_topTADs.R TCGAluad_mutKRAS_mutEGFR 5 pipelineConsensus
# 
# Rscript intersect_topTADs.R TCGAkich_norm_kich 5 ENCSR079VIJ_G401_40kb ENCSR401TBQ_Caki2_40kb ENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAkich_norm_kich 5 ENCSR079VIJ_G401_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 5 ENCSR401TBQ_Caki2_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 5 ENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kb
# Rscript intersect_topTADs.R TCGAkich_norm_kich 5 pipelineConsensus
# 
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 5 ENCSR312KHQ_SK-MEL-5_40kb ENCSR862OGI_RPMI-7951_40kb ENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kb pipelineConsensus
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 5 ENCSR312KHQ_SK-MEL-5_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 5 ENCSR862OGI_RPMI-7951_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 5 ENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kb
# Rscript intersect_topTADs.R TCGAskcm_wt_mutCTNNB1 5 pipelineConsensus

# tail -n+2 TCGAskcm_wt_mutCTNNB1_ENCSR312KHQ_SK-MEL-5_40kb_3.txt | \
# cut -f1 | \
# paste -sd" "
# ACTN3 BBS1 C11orf80 CCDC87 CCS CTSF DPP3 FTLP6 LOC100422299 LOC100505504 LOC100505524 LOC101928069 LOC101928090 MRPL11 NPAS4 PELI3 RBM14 RBM14-RBM4 RBM4 RBM4B SLC29A2 SPTBN2 ZDHHC24 ABCA17P ABCA3 AMDHD2 ATP6V0C BRICD5 C16orf59 CASKIN1 CCNF CEMP1 DNASE1L2 E4F1 ECI1 LOC729652 MIR3178 MIR3677 MIR4717 MIR940 MLST8 NTN3 PDPK1 PGP RNPS1 RPS16P7 TBC1D24 ADAMTSL5 APC2 ATP8B3 C19orf25 DAZAP1 EFNA2 GAMT LOC100288123 LOC101928518 LOC101928543 MBD3 MEX3D MIR1909 MUM1 NDUFS7 ONECUT3 PCSK4 PLK5 REEP6 RPS15 RPS15P9 TCF3 TRNAF10 TRNAN20 UQCR11 DBN1 DDX41 DOK3 F12 FAM193B GRK6 PDLIM7 PFN3 PRR7 PRR7-AS1 SLC34A1 CETN2 CSAG1 CSAG2 CSAG3 CSAG4 GABRQ LOC100420250 MAGEA12 MAGEA2 MAGEA2B MAGEA3 MAGEA6 NSDHL PSMAGEA ZNF185
# 
# tail -n+2 TCGAskcm_wt_mutCTNNB1_ENCSR862OGI_RPMI-7951_40kb_3.txt | \
# cut -f1 | \
# paste -sd" "
# AXIN1 C16orf11 C16orf13 CAPN15 DECR2 FAM195A LINC00235 LOC100130285 LOC100134368 LOC100287175 LOC100996484 LOC101929183 LOC101929253 LOC101929280 LOC101929365 MIR3176 MIR5587 MRPL28 NHLRC4 NME4 PIGQ RAB11FIP3 RAB40C RHOT2 RPL23AP5 TMEM8A TRNAG4 WDR90 WFIKKN1 ANKRD24 APBA3 ATCAY CREB3L3 DAPK3 EBI3 EEF2 FTLP5 MAP2K2 MATK MIR637 MRPL54 NMRK2 PIAS4 PIP5K1C RAX2 SIRT6 SNORD37 TJP3 ZBTB7A ZFR2 ADAMTSL5 APC2 C19orf25 DAZAP1 EFNA2 GAMT MUM1 NDUFS7 PCSK4 REEP6 RPS15 RPS15P9 TRNAF10 TRNAN20 ARF4P2 ARFGAP1 BHLHE23 BIRC7 CHRNA4 COL20A1 DIDO1 FLJ16779 GID8 HAR1A HAR1B KCNQ2 LINC00029 LOC100130587 LOC100144597 LOC63930 MIR124-3 MIR3196 MIR4326 NKAIN4 SLC17A9 TCFL5 YTHDF1 CCDC39 DNAJC19 FAUP2 FLJ46066 FLYWCH1P1 FXR1 LOC100132223 LOC100132918 LOC100996490 LOC101928856 LOC101928882 LOC101929598 LOC647253 RPL32P10 RPL7AP25 RPL7L1P8 SOX2 SOX2-OT TTC14 C5orf38 IRX1 IRX2 IRX4 LINC01019 LOC100130748 LOC100506858 LOC101929003 LOC101929034 LOC101929056 LOC101929081 LOC101929108 LOC101929153 MRPL36 NDUFS6 CASC9 CRISPLD1 FLJ39080 GDAP1 HIGD1AP18 HIGD1AP6 HNF4G JPH1 LOC101926965 LOC101926978 MIR2052 MIR5681A MIR5681B MRPL9P1 PCBP2P2 PEX2 PI15 RPS3AP32 ZFHX4 ZFHX4-AS1 CETN2 CNGA2 CSAG1 CSAG2 CSAG3 CSAG4 FATE1 GABRA3 GABRE GABRQ KRT8P8 LOC100420250 MAGEA10 MAGEA10-MAGEA5 MAGEA12 MAGEA2 MAGEA2B MAGEA3 MAGEA4 MAGEA5 MAGEA6 MIR105-1 MIR105-2 MIR224 MIR452 MIR767 NSDHL PNMA3 PNMA5 PNMA6D PSMAGEA RPSAP60 ZNF185
# 
# tail -n+2 TCGAskcm_wt_mutCTNNB1_ENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kb_3.txt | \
# cut -f1 | \
# paste -sd" "
# C1orf180 C1orf52 CTBS DNASE2B GNG5 LOC100128775 LOC101927611 LOC101927633 LOC101927656 LOC101927773 LPAR3 MCOLN2 MCOLN3 MIR4423 RPF1 SAMD13 SPATA1 SSX2IP SYDE2 UOX WDR63 AXIN1 C16orf11 C16orf13 CAPN15 DECR2 FAM195A LINC00235 LOC100130285 LOC100134368 LOC100287175 LOC100996484 LOC101929183 LOC101929253 LOC101929280 LOC101929365 MIR3176 MIR5587 MRPL28 NHLRC4 NME4 PIGQ RAB11FIP3 RAB40C RHOT2 RPL23AP5 TMEM8A TRNAG4 WDR90 WFIKKN1 ADAMTSL5 APC2 ATP8B3 C19orf25 DAZAP1 EFNA2 GAMT LOC100288123 LOC101928518 LOC101928543 MBD3 MEX3D MIR1909 MUM1 NDUFS7 ONECUT3 PCSK4 PLK5 REEP6 REXO1 RPS15 RPS15P9 TCF3 TRNAF10 TRNAN20 UQCR11 ARF4P2 ARFGAP1 BHLHE23 BIRC7 CHRNA4 COL20A1 DIDO1 FLJ16779 GID8 HAR1A HAR1B KCNQ2 LINC00029 LOC100130587 LOC100144597 LOC63930 MIR124-3 MIR3196 MIR4326 NKAIN4 SLC17A9 TCFL5 YTHDF1
# 
# tail -n+2 TCGAskcm_wt_mutCTNNB1_pipelineConsensus_3.txt | \
# cut -f1 | \
# paste -sd" "
# ACTN3 BBS1 CCDC87 CCS CTSF DPP3 LOC100505504 LOC100505524 LOC101928069 LOC101928090 MRPL11 NPAS4 PELI3 RBM14 RBM14-RBM4 RBM4 RBM4B SLC29A2 SPTBN2 ZDHHC24 ARHGDIG AXIN1 DECR2 HBA1 HBA2 HBAP1 HBM HBQ1 HBZ HBZP1 IL9RP3 ITFG3 LOC100129478 LOC100134368 LOC100996484 LUC7L MPG MRPL28 NME4 NPRL3 PDIA2 POLR3K RAB11FIP3 RGS11 RHBDF1 RPL23AP5 SNRNP25 TMEM8A C16orf11 C16orf13 CAPN15 CCDC78 FAM173A FAM195A FBXL16 HAGHL JMJD8 LINC00235 LOC100130285 LOC100287175 LOC101929183 LOC101929253 LOC101929280 LOC101929365 METRN MIR3176 MIR5587 NARFL NHLRC4 PIGQ RAB40C RHBDL1 RHOT2 STUB1 TRNAG4 WDR24 WDR90 WFIKKN1 ABHD17A ADAMTSL5 APC2 ATP8B3 C19orf25 DAZAP1 EFNA2 GAMT KLF16 LOC100288123 LOC101928518 LOC101928543 MBD3 MEX3D MIR1909 MUM1 NDUFS7 ONECUT3 PCSK4 PLK5 REEP6 REXO1 RPS15 RPS15P9 TCF3 TRNAF10 TRNAN20 UQCR11 C19orf70 HSD11B1L LONP1 PTPRS RPL32P34 RPL36 SAFB SAFB2 SNRPEP4 TINCR ZNRF4 DBN1 F12 GRK6 LMAN2 MXD3 NSD1 PDLIM7 PFN3 PRELID1 PRR7 PRR7-AS1 RAB24 RGS14 RPS20P17 SLC34A1
# tail -n+2 TCGAskcm_wt_mutCTNNB1_ENCSR312KHQ_SK-MEL-5_40kbENCSR862OGI_RPMI-7951_40kbENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kbpipelineConsensus_3.txt | \
#   cut -f1 | \
#   paste -sd" "
# ADAMTSL5 APC2 C19orf25 DAZAP1 EFNA2 GAMT MUM1 NDUFS7 PCSK4 REEP6 RPS15 RPS15P9 TRNAF10 TRNAN20

# tail -n+2 TCGAkich_norm_kich_ENCSR079VIJ_G401_40kb_3.txt | \
# cut -f1 | \
# paste -sd" "
# CHTOP ILF2 INTS3 LOC101928034 LOC101929669 LOC645900 NPR1 PGLYRP3 PGLYRP4 S100A1 S100A12 S100A13 S100A14 S100A16 S100A2 S100A3 S100A4 S100A5 S100A6 S100A7 S100A7A S100A7L2 S100A7P1 S100A7P2 S100A8 S100A9 SLC27A3 SNAPIN TRNAM3 DHCR7 FLJ42102 KRTAP5-10 KRTAP5-13P KRTAP5-7 KRTAP5-8 KRTAP5-9 LOC101928500 LOC101928528 MIR3664 NADSYN1 S100A11P3 SHANK2 SHANK2-AS1 SHANK2-AS3 C5orf38 IRX1 IRX2 LINC01019 LOC100130748 LOC100506858 LOC101929153
# 
# tail -n+2 TCGAkich_norm_kich_ENCSR401TBQ_Caki2_40kb_3.txt | \
# cut -f1 | \
# paste -sd" "
# CHTOP CREB3L4 CRTC2 DENND4B GATAD2B ILF2 INTS3 JTB LOC101928059 LOC101929669 LOC343052 LOC645965 NPR1 RAB13 S100A1 S100A13 S100A14 S100A16 SLC27A3 SLC39A1 SNAPIN TRNAM3 CLEC19A ITPRIPL2 SYT17 TMC5 AMFR BBS2 DPPA2P4 LOC101927536 MT1A MT1B MT1CP MT1DP MT1E MT1F MT1G MT1H MT1IP MT1JP MT1L MT1M MT1X MT2A MT3 MT4 NUDT21 NUP93 OGFOD1 KATNAL2 LOC100421737 PIAS2 RPS21P6 ST8SIA5 TCEB3C TCEB3CL TCEB3CL2 ABHD17A ADAT3 AMH AP3D1 BTBD2 C19orf35 CSNK1G2 CSNK1G2-AS1 DOT1L IZUMO4 JSRP1 LINGO3 LOC100421552 LOC101928572 LSM7 MIR1227 MIR4321 MKNK2 MOB3A OAZ1 PLEKHJ1 SCAMP4 SF3A2 SPPL2B TMPRSS9 ALDH7A1P3 AOC1 EIF2AP2 EIF2AP3 GIMAP1 GIMAP1-GIMAP5 GIMAP2 GIMAP3P GIMAP4 GIMAP5 GIMAP6 GIMAP7 LOC100128542 LOC100288724 STRADBP1 TMEM176A TMEM176B BAALC C8orf56 CTHRC1 DCAF13 FLJ10489 FZD6 LOC100499183 LOC101927343 MIR3151 MTND1P5 MTND2P10 RIMS2 SLC25A32
# 
# tail -n+2 TCGAkich_norm_kich_ENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kb_3.txt | \
# cut -f1 | \
# paste -sd" "
# ABHD17A ADAT3 AMH AP3D1 BTBD2 C19orf35 CSNK1G2 CSNK1G2-AS1 DOT1L IZUMO4 JSRP1 LINGO3 LOC100421552 LOC101928572 LSM7 MIR1227 MIR4321 MKNK2 MOB3A OAZ1 PLEKHJ1 SCAMP4 SF3A2 SPPL2B TMPRSS9 ACOT8 CTSA NEURL2 PCIF1 PLTP SNX21 SPATA25 TNNC2 UBE2C ZSWIM1 ZSWIM3 C5orf38 IRX1 IRX2 LINC01019 LOC100130748 LOC100506858 LOC101929153
# 
# 
# tail -n+2 TCGAkich_norm_kich_pipelineConsensus_3.txt | \
# cut -f1 | \
# paste -sd" "
# CHTOP CREB3L4 CRTC2 DENND4B GATAD2B ILF2 INTS3 JTB LOC101928034 LOC101928059 LOC101929669 LOC343052 LOC645965 NPR1 RAB13 S100A1 S100A13 S100A14 S100A16 S100A2 S100A3 SLC27A3 SLC39A1 SNAPIN TRNAM3 AMFR BBS2 DPPA2P4 LOC101927536 MT1A MT1B MT1CP MT1DP MT1E MT1F MT1G MT1H MT1IP MT1JP MT1L MT1M MT1X MT2A MT3 MT4 NUDT21 NUP93 OGFOD1 AMH AP3D1 BTBD2 C19orf35 CSNK1G2 CSNK1G2-AS1 DOT1L IZUMO4 JSRP1 LINGO3 LMNB2 LOC100421552 LOC101928572 LSM7 MIR1227 MIR4321 MKNK2 MOB3A OAZ1 PLEKHJ1 SCAMP4 SF3A2 SPPL2B TIMM13 TMPRSS9 CD177 CD177P1 CEACAM1 CEACAM8 CEACAMP1 CEACAMP10 CEACAMP11 CEACAMP2 CEACAMP4 CEACAMP5 CEACAMP6 CEACAMP7 CEACAMP8 CEACAMP9 LIPE-AS1 LOC100289650 LOC100421300 LOC101928003 LOC284344 PRG1 PSG1 PSG10P PSG11 PSG2 PSG3 PSG4 PSG5 PSG6 PSG7 PSG8 PSG9 RPS10P28 TEX101
# 
# tail -n+2 TCGAkich_norm_kich_ENCSR079VIJ_G401_40kbENCSR401TBQ_Caki2_40kbENCSR079VIJ_G401ENCSR401TBQ_Caki2_40kbpipelineConsensus_3.txt | \
# cut -f1 | \
# paste -sd" "
# -
# 
# tail -n+2 TCGAluad_mutKRAS_mutEGFR_ENCSR444WCZ_A549_40kb_3.txt | \
# cut -f1 | \
# paste -sd" "
# C2CD4D CELF3 CGN LINGO4 LOC100132111 LOC100270670 LOC101927909 LOC101927929 MIR554 MRPL9 OAZ3 POGZ PSMB4 RIIAD1 RNY4P25 RORC RPS10P6 RPS11P3 SNX27 TDRKH THEM5 TUFT1 ACAD8 B3GAT1 GLB1L2 GLB1L3 LOC100421417 LOC100507548 LOC283177 THYN1 HOTAIR HOXC-AS1 HOXC-AS5 HOXC10 HOXC11 HOXC12 HOXC13 HOXC4 HOXC9 MIR196A2 AGRP ATP6V0D1 FHOD1 HSD11B2 KCTD19 LOC101927837 LRRC29 LRRC36 PLEKHG4 SLC9A5 TMEM208 TPPP3 ZDHHC1 HOXB-AS1 HOXB-AS3 HOXB1 HOXB2 HOXB3 HOXB4 HOXB5 HOXB6 HOXB7 HOXB8 HOXB9 LOC101927148 LOC101927166 LSM3P1 MIR10A MIR196A1 SKAP1 KIR2DL1 KIR2DL3 KIR2DL4 KIR2DP1 KIR3DL3 KIR3DP1 KIR3DX1 LAIR2 LILRA1 LILRA2 LILRB1 LILRB4 LILRP1 LILRP2 LOC101928804 VN1R105P BPIFA1 BPIFA2 BPIFA3 BPIFA4P BPIFB1 BPIFB2 BPIFB3 BPIFB4 BPIFB5P BPIFB6 BPIFB9P CDK5RAP1 HDHD1P3 LOC101928239 LOC101928282 RPL12P3 SOCS2P1 SUN5 ARHGAP8 FAM118A FBLN1 KIAA0930 LOC100506714 LOC101927551 MIR1249 NUP50 PHF21B PRR5-ARHGAP8 RIBC2 RPL6P28 RPS10P31 SMC1B UPK3A HLA-DOB HLA-DQA1 HLA-DQA2 HLA-DQB1 HLA-DQB2 HLA-DRA HLA-DRB1 HLA-DRB5 HLA-DRB6 HLA-DRB9 MIR3135B MTCO3P1 AK3P3 GPNMB IGF2BP3 KLHL7 KLHL7-AS1 LOC101927890 LOC389473 MALSU1 NUPL2 RPS2P32 TRA2A CCT6A CDC42P2 CHCHD2 CICP11 CICP12 FKBP9L GBAS LOC100419984 LOC100420539 LOC100420540 LOC101060139 LOC101060341 LOC101409255 LOC101928755 LOC442309 LOC643348 MRPS17 NUPR1L PHKG1 PSPH PSPHP1 SEPT14 SNORA15 SUMF2 SUMO2P3 TUBBP6 ZNF713 C9orf116 C9orf69 CAMSAP1 ESP33 GLT6D1 KCNT1 LCN1 LCN9 LHX3 LOC100130954 LOC101928525 LOC101928552 LOC101928645 LOC101928722 LOC101928758 LOC138159 MRPS2 NACC2 OBP2A PAEP PPP1R26 PPP1R26-AS1 QSOX2 SOCS5P2 SOHLH1 UBAC1 ANKRD18B ANXA2P2 APTX AQP3 AQP7 B4GALT1 bA255A11.4 BAG1 CHMP5 DNAJA1 LOC100862682 LOC101929639 LOC101929665 LOC101929688 LOC646808 NFX1 NOL6 PRSS3 PTENP1 PTENP1-AS SMU1 SNX18P7 SPINK4 SUGT1P1 TRBV20OR9-2 TRBV21OR9-2 TRBV22OR9-2 TRBV23OR9-2 TRBV24OR9-2 TRBV25OR9-2 TRBV26OR9-2 TRBV29OR9-2 TRBVAOR9-2 UBE2R2 VN1R47P CETN2 CNGA2 CSAG1 CSAG2 CSAG3 CSAG4 FATE1 GABRA3 GABRE GABRQ KRT8P8 LOC100420250 MAGEA10 MAGEA10-MAGEA5 MAGEA12 MAGEA2 MAGEA2B MAGEA3 MAGEA4 MAGEA5 MAGEA6 MIR105-1 MIR105-2 MIR224 MIR452 MIR767 NSDHL PNMA3 PNMA5 PNMA6D PSMAGEA RPSAP60 ZNF185
# 
# tail -n+2 TCGAluad_mutKRAS_mutEGFR_NCI-H460_40kb_3.txt | \
# cut -f1 | \
# paste -sd" "
# C1orf68 IVL KPRP LCE1A LCE1B LCE1C LCE1D LCE1E LCE1F LCE2A LCE2B LCE2C LCE2D LCE3A LCE3B LCE3C LCE3D LCE3E LCE4A LCE6A LCEP1 LCEP2 LCEP3 LCEP4 LELP1 LOC101927988 LOC101928009 LOR PRR9 RPLP0P4 SMCP SPRR1A SPRR1B SPRR2A SPRR2B SPRR2C SPRR2D SPRR2E SPRR2F SPRR2G SPRR3 SPRR4 AKR1C1 AKR1C2 AKR1C3 AKR1C4 AKR1C5P AKR1C6P AKR1C7P AKR1CL1 AKR1E2 LOC101928027 LOC101928051 NET1 RPL26P28 TUBAL3 UCN3 ACAD8 GLB1L3 LOC100421417 THYN1 ALG1 ANKS3 C16orf71 C16orf89 C16orf96 CDIP1 FAM86A GLYR1 HMOX2 MGRN1 NAGPA NAGPA-AS1 NMRAL1 NUDT16L1 PPL ROGDI SEC14L5 SEPT12 SMIM22 UBALD1 UBN1 ZNF500 CASP16 CCDC64B CLDN6 CLDN9 HCFC1R1 IL32 LOC100128770 LOC100507419 LOC100507458 LOC101929613 LOC101929668 MMP25 RNU1-22P THOC6 TNFRSF12A TRNAK15 TRNAK21 TRNAK26 TRNAP12 TRNAP16 TRNAP18 TRNAP19 TRNAP21 TRNAP24P TRNAP26P TRNAP9 TRNAR18 TRNAR19 ZNF205 ZNF205-AS1 ZNF213 ZSCAN10 AGRP ATP6V0D1 FHOD1 HSD11B2 KCTD19 LOC101927837 LRRC29 LRRC36 PLEKHG4 SLC9A5 TMEM208 TPPP3 ZDHHC1 CBX1 CDK5RAP3 COPZ2 HOXB-AS1 HOXB-AS3 HOXB1 HOXB2 HOXB3 HOXB4 HOXB5 HOXB6 HOXB7 HOXB8 HOXB9 LOC100506325 LOC101927122 LOC101927148 LOC101927166 LOC101929078 LRRC46 LSM3P1 MIR10A MIR1203 MIR152 MIR196A1 MRPL10 NFE2L1 OSBPL7 PNPO PRR15L SCRN2 SKAP1 SNX11 SP2 SP6 ATP5G1P6 HMSD SERPINB10 SERPINB11 SERPINB12 SERPINB13 SERPINB2 SERPINB3 SERPINB4 SERPINB5 SERPINB7 SERPINB8 KIR2DL1 KIR2DL3 KIR2DL4 KIR2DP1 KIR3DL3 KIR3DP1 LILRB1 LILRB4 LILRP1 LILRP2 LOC101928804 VN1R105P APOBEC3A APOBEC3B APOBEC3C APOBEC3D APOBEC3F APOBEC3G APOBEC3H CBX6 CBX7 COX5BP7 DNAL4 FUNDC2P4 LOC101927202 NPTXR SUN2 HLA-DQA1 HLA-DQA2 HLA-DQB1 HLA-DQB2 HLA-DRA HLA-DRB1 HLA-DRB5 HLA-DRB6 HLA-DRB9 MIR3135B MTCO3P1 CCT6A CDC42P2 CHCHD2 CICP11 CICP12 FKBP9L GBAS LANCL2 LOC100129276 LOC100419984 LOC100420539 LOC100420540 LOC101060139 LOC101060341 LOC101409255 LOC101928755 LOC643348 MRPS17 NUPR1L PHKG1 PSPH PSPHP1 SEPT14 SNORA15 SUMF2 SUMO2P3 TUBBP6 VOPP1 ZNF713 CDK5PS DERL1 FAM83A FAM83A-AS1 HMGB1P19 MIR4663 RNY4P5 TBC1D31 TRNAM11 ZHX2 CHMP7 LOC100507156 LOC254896 LOC286059 LOC389641 LOXL2 R3HCC1 RHOBTB2 RPL23AP55 TNFRSF10A TNFRSF10B TNFRSF10C TNFRSF10D ANKRD18B APTX AQP3 AQP7 B4GALT1 BAG1 CHMP5 DNAJA1 LOC100862682 LOC101929639 LOC646808 NFX1 NOL6 SMU1 SPINK4 SUGT1P1 VN1R47P
# 
# tail -n+2 TCGAluad_mutKRAS_mutEGFR_ENCSR444WCZ_A549NCI-H460_40kb_3.txt | \
# cut -f1 | \
# paste -sd" "
# C2CD4D CELF3 CGN LINGO4 LOC100132111 LOC100270670 LOC101927909 LOC101927929 MIR554 MRPL9 OAZ3 POGZ PSMB4 RIIAD1 RNY4P25 RORC RPS10P6 RPS11P3 SNX27 TDRKH THEM5 TUFT1 GABARAPL1 KLRC1 KLRC2 KLRC3 KLRC4 KLRC4-KLRK1 KLRD1 KLRK1 LOC101060038 LOC101928100 LOC255308 AGRP ATP6V0D1 FHOD1 HSD11B2 KCTD19 LOC101927837 LRRC29 LRRC36 PLEKHG4 SLC9A5 TMEM208 TPPP3 ZDHHC1 ALG1 ANKS3 C16orf71 C16orf89 C16orf96 CDIP1 FAM86A GLYR1 HMOX2 MGRN1 NAGPA NAGPA-AS1 NMRAL1 NUDT16L1 PPL ROGDI SEC14L5 SEPT12 SMIM22 UBALD1 UBN1 ZNF500 ATP5G1P6 HMSD SERPINB10 SERPINB11 SERPINB12 SERPINB13 SERPINB2 SERPINB3 SERPINB4 SERPINB5 SERPINB7 SERPINB8 HLA-DQA1 HLA-DQA2 HLA-DQB1 HLA-DQB2 HLA-DRA HLA-DRB1 HLA-DRB5 HLA-DRB6 HLA-DRB9 MIR3135B MTCO3P1 CCT6A CDC42P2 CHCHD2 CICP11 CICP12 FKBP9L GBAS LANCL2 LOC100129276 LOC100419984 LOC100420539 LOC100420540 LOC101060139 LOC101060341 LOC101409255 LOC101928755 LOC643348 MRPS17 NUPR1L PHKG1 PSPH PSPHP1 SEPT14 SNORA15 SUMF2 SUMO2P3 TUBBP6 VOPP1 ZNF713 CHMP7 ENTPD4 LOC100507156 LOC254896 LOC286059 LOC389641 LOXL2 R3HCC1 RPL23AP55 TNFRSF10A TNFRSF10B TNFRSF10C TNFRSF10D DUSP4 FAM183CP LEPROTL1 LINC00589 LOC101929450 LOC101929470 MAP2K1P1 MIR3148 RPL17P33 TMEM66
# 
# tail -n+2 TCGAluad_mutKRAS_mutEGFR_pipelineConsensus_3.txt | \
# cut -f1 | \
# paste -sd" "
# ACTG1P4 AMY1A AMY2A AMY2B RNPC3 AKR1C1 AKR1C2 AKR1C3 AKR1C4 AKR1C5P AKR1C6P AKR1C7P AKR1CL1 AKR1E2 LOC101928027 LOC101928051 RPL26P28 UCN3 ACAD8 B3GAT1 GLB1L2 GLB1L3 LOC100421417 LOC100507548 LOC283177 THYN1 GABARAPL1 KLRAP1 KLRC1 KLRC2 KLRC3 KLRC4 KLRC4-KLRK1 KLRD1 KLRK1 LOC101060038 LOC101928100 LOC255308 MAGOHB STYK1 YBX3 ALG1 ANKS3 C16orf71 C16orf89 FAM86A GLYR1 NAGPA NAGPA-AS1 NUDT16L1 PPL ROGDI SEC14L5 SEPT12 SMIM22 UBN1 ZNF500 FHOD1 HSD11B2 KCTD19 LRRC36 PLEKHG4 SLC9A5 TPPP3 ZDHHC1 BAK1P1 BPIFA1 BPIFA2 BPIFA3 BPIFA4P BPIFB1 BPIFB2 BPIFB3 BPIFB4 BPIFB5P BPIFB6 BPIFB9P C20orf203 COMMD7 DNMT3B EFCAB8 HDHD1P3 LOC101928239 LOC101928282 MAPRE1 RPL12P3 SOCS2P1 SUN5 APOBEC3A APOBEC3B APOBEC3C APOBEC3D APOBEC3F APOBEC3G APOBEC3H CBX6 CBX7 COX5BP7 DNAL4 FUNDC2P4 LOC101927202 NPTXR SUN2 HLA-DOB HLA-DQA1 HLA-DQA2 HLA-DQB1 HLA-DQB2 HLA-DRB1 HLA-DRB6 MIR3135B MTCO3P1 PSMB8 PSMB9 TAP1 TAP2 TAPSAR1 CCT6A CHCHD2 CICP11 CICP12 FKBP9L GBAS LOC100419984 LOC100420539 LOC100420540 LOC101060139 LOC101060341 LOC101409255 LOC101928755 MRPS17 NUPR1L PHKG1 PSPH PSPHP1 SEPT14 SNORA15 SUMF2 SUMO2P3 ZNF713 ATAD2 C8orf76 CDK5PS DERL1 DUTP2 FAM83A FAM83A-AS1 HMGB1P19 IMPDH1P6 LOC392266 MIR4663 MIR548AA1 MIR548D1 RNY4P5 TBC1D31 TRNAF14P TRNAM11 UBA52P5 WDYHV1 ZHX1 ZHX1-C8ORF76 ZHX2 DUSP4 FAM183CP LEPROTL1 LINC00589 LOC101929450 LOC101929470 MAP2K1P1 MIR3148 RPL17P33 TMEM66 C9orf116 C9orf69 CAMSAP1 CARD9 DKFZP434A062 DNLZ ESP33 GLT6D1 GPSM1 KCNT1 LCN1 LCN9 LHX3 LOC100130954 LOC101928525 LOC101928552 LOC101928645 LOC101928722 LOC101928758 LOC138159 MRPS2 NACC2 OBP2A PAEP PPP1R26 PPP1R26-AS1 QSOX2 SOHLH1 UBAC1
# 
# tail -n+2 TCGAluad_mutKRAS_mutEGFR_ENCSR444WCZ_A549_40kbNCI-H460_40kbENCSR444WCZ_A549NCI-H460_40kbpipelineConsensus_3.txt | \
#   cut -f1 | \
#   paste -sd" "
# CCT6A CHCHD2 CICP11 CICP12 FHOD1 FKBP9L GBAS HLA-DQA1 HLA-DQA2 HLA-DQB1 HLA-DQB2 HLA-DRB1 HLA-DRB6 HSD11B2 KCTD19 LOC100419984 LOC100420539 LOC100420540 LOC101060139 LOC101060341 LOC101409255 LOC101928755 LRRC36 MIR3135B MRPS17 MTCO3P1 NUPR1L PHKG1 PLEKHG4 PSPH PSPHP1 SEPT14 SLC9A5 SNORA15 SUMF2 SUMO2P3 TPPP3 ZDHHC1 ZNF713#
# #

startTime <- Sys.time()

require(foreach)

source("utils_fct.R")

setDir=""
setDir <- "~/media/electron"
setDir="" 

outFolder <- file.path("INTERSECT_topTADs")
dir.create(outFolder, recursive = TRUE)

args <- commandArgs(trailingOnly = TRUE)

all_hicds <- c("ENCSR312KHQ_SK-MEL-5_40kb", "ENCSR862OGI_RPMI-7951_40kb", "ENCSR312KHQ_SK-MEL-5ENCSR862OGI_RPMI-7951_40kb")
exprds <- "TCGAskcm_wt_mutCTNNB1"
topThresh <- 5
all_hicds <- c("ENCSR444WCZ_A549_40kb", "NCI-H460_40kb" ,"ENCSR444WCZ_A549_NCI-H460_40kb", "pipelineConsensus")
exprds <- "TCGAluad_mutKRAS_mutEGFR"
topThresh <- 10
all_hicds <- "ENCSR079VIJ_G401_40kb"
exprds <- "TCGAkich_norm_kich"
topThresh <- 3
stopifnot(length(args) > 2)


all_hicds <- args[3:length(args)]
exprds <- args[1]
topThresh <- as.numeric(args[2])

stopifnot(!is.na(topThresh))
stopifnot(topThresh > 0)

entrezDT_file <- paste0(setDir, "/mnt/ed4/marie/entrez2synonym/entrez/ENTREZ_POS/gff_entrez_position_GRCh37p13_nodup.txt")
entrezDT <- read.delim(entrezDT_file, header=TRUE, stringsAsFactors = FALSE)
entrezDT$entrezID <- as.character(entrezDT$entrezID)
head(entrezDT)

#PIPELINE/OUTPUT_FOLDER/GSE105318_DLD1_40kb/TCGAcoad_msi_mss//emp_pval_combined.Rdata
script11_name <- "11_runEmpPvalCombined"

all_topTADsGenes <- foreach(hicds = all_hicds) %dopar% {
  
  if(hicds == "pipelineConsensus") {
    pipOutDir <- file.path(setDir, "/mnt/ed4/marie/scripts/TAD_DE_pipeline_v2_TopDom", "OUTPUT_FOLDER",  exprds)
    
    # file with assignment from entrez to all regions
    gene2tadDT_file <- paste0(setDir, 
                              "/mnt/ed4/marie/gene_data_final/consensus_TopDom_covThresh_r0.6_t80000_v0_w-1_final/genes2tad/all_genes_positions.txt") 
  } else {
    stopifnot(dir.exists(hicds))
    pipOutDir <- file.path("PIPELINE", "OUTPUT_FOLDER", hicds, exprds)
    gene2tadDT_file <- file.path(hicds, "genes2tad/all_genes_positions.txt")
  }
  stopifnot(file.exists(gene2tadDT_file))
  g2tDT <- read.delim(gene2tadDT_file, stringsAsFactors = FALSE, header=F, col.names=c("entrezID", "chromo", "start", "end", "region"))
  
  stopifnot(g2tDT$entrezID %in% entrezDT$entrezID)
  g2t2sDT <- merge(g2tDT[, c("entrezID", "region")], entrezDT[,c("entrezID", "symbol")], by="entrezID", all.x = TRUE, all.y = FALSE )
  head(g2t2sDT)
  stopifnot(!is.na(g2t2sDT))
  g2t2sDT$entrezID <- as.character(g2t2sDT$entrezID)
  g2t2sDT$region <- as.character(g2t2sDT$region)
  g2t2sDT$symbol <- as.character(g2t2sDT$symbol)
  
  stopifnot(dir.exists(pipOutDir))
  stopifnot(dir.exists(file.path(pipOutDir, script11_name)))
  
  tad_pvalFile <- file.path(pipOutDir, script11_name, "emp_pval_combined.Rdata")
  stopifnot(file.exists(tad_pvalFile))
  tad_pvals <- eval(parse(text = load(tad_pvalFile)))
  
  adj_tad_pvals <- sort(p.adjust(tad_pvals, method="BH"))
  
  if(topThresh >= 1) {
    topThresh <- min(c(topThresh, length(adj_tad_pvals)))
    pvalThresh <- as.numeric(adj_tad_pvals[topThresh])
    stopifnot(!is.na(pvalThresh))
    stopifnot(pvalThresh <= 1)
  } else {
    pvalThresh <- topThresh
  }
  top_pvals <- adj_tad_pvals[adj_tad_pvals <= pvalThresh]
  stopifnot(!is.na(top_pvals))
  
  if(topThresh >= 1) stopifnot(length(unique(top_pvals)) <= topThresh)
  
  top_tads <- names(top_pvals)
  
  tad_ranks <- rank(top_pvals, ties="min")
  stopifnot(top_tads %in% names(tad_ranks))
  tad_ranks <- tad_ranks[top_tads]
  
  topTADsDT <- data.frame(
    top_tads = top_tads,
    tad_rank = tad_ranks,
    top_pvals = as.numeric(top_pvals),
    stringsAsFactors = FALSE
  )
  head(topTADsDT)
  
  stopifnot(top_tads %in% g2t2sDT$region)
  topGenesDT <- g2t2sDT[g2t2sDT$region %in% top_tads,]
  head(topGenesDT)
  
  colnames(topGenesDT)[colnames(topGenesDT) == "region"] <- "top_tads"
  
  topTADs_genesDT <- merge(topTADsDT, topGenesDT[, c("top_tads", "symbol")], by = "top_tads", all.x=TRUE, all.y=TRUE)
  
  topTADs_genesDT$top_tads <- as.character(topTADs_genesDT$top_tads)
  topTADs_genesDT$symbol <- as.character(topTADs_genesDT$symbol)
  topTADs_genesDT <- topTADs_genesDT[order(topTADs_genesDT$top_pvals, topTADs_genesDT$top_tads, topTADs_genesDT$symbol),]
  head(topTADs_genesDT)
  
  topTADs_genesDT
}
names(all_topTADsGenes) <- all_hicds
str(all_topTADsGenes)

intersectGenes <- Reduce(intersect, lapply(all_topTADsGenes, function(x) x[["symbol"]]))

filtered_topTADsGenes <- lapply(all_topTADsGenes, function(x) x[x[["symbol"]] %in% intersectGenes,, drop=F])
filtered_topTADsGenes <- lapply(filtered_topTADsGenes, function(x) x[order(x[["symbol"]]),])

filtered_topTADsGenesDT <- do.call('cbind', filtered_topTADsGenes)

all_symbolsDT <- filtered_topTADsGenesDT[, grepl("\\.symbol$", colnames(filtered_topTADsGenesDT)), drop=F]
stopifnot(apply(all_symbolsDT, 1, function(x) length(unique(x)) == 1))
all_symbols <- as.character(all_symbolsDT[,1])
filtered_topTADsGenesDT[, grepl("\\.symbol$", colnames(filtered_topTADsGenesDT))] <- NULL
rownames(filtered_topTADsGenesDT) <- all_symbols
head(filtered_topTADsGenesDT)

all_ranksDT <- filtered_topTADsGenesDT[, grepl("\\.tad_rank$", colnames(filtered_topTADsGenesDT)), drop=F]
filtered_topTADsGenesDT$rank_mean <- rowMeans(all_ranksDT)
head(filtered_topTADsGenesDT)
filtered_topTADsGenesDT$gene <- as.character(rownames(filtered_topTADsGenesDT))

filtered_topTADsGenesDT[, grepl("\\.tad_rank$", colnames(filtered_topTADsGenesDT))] <- NULL


filtered_topTADsGenesDT <- filtered_topTADsGenesDT[, c(which(colnames(filtered_topTADsGenesDT) == "gene"),
                                                       which(colnames(filtered_topTADsGenesDT) == "rank_mean"),
                                                       which(! colnames(filtered_topTADsGenesDT) %in% c("gene", "rank_mean"))), drop=F]

if(length(all_hicds) == 1) {
  toptads_col <- colnames(filtered_topTADsGenesDT)[grepl("\\.top_tads", colnames(filtered_topTADsGenesDT))]
  stopifnot( toptads_col %in% colnames(filtered_topTADsGenesDT) )
  filtered_topTADsGenesDT <- filtered_topTADsGenesDT[order(filtered_topTADsGenesDT$rank_mean, 
                                                           filtered_topTADsGenesDT[,toptads_col],
                                                           filtered_topTADsGenesDT$gene),, drop=F ]
} else {
  filtered_topTADsGenesDT <- filtered_topTADsGenesDT[order(filtered_topTADsGenesDT$gene, filtered_topTADsGenesDT$rank_mean),, drop=F ]
}
head(filtered_topTADsGenesDT)

cat("\n\n\n")

write.table(head(filtered_topTADsGenesDT), col.names=T, row.names=F, sep="\t", quote=F, file="")

outFile <- file.path(outFolder, 
                     paste0(exprds, "_", paste0(all_hicds, collapse=""), "_", topThresh, ".txt"))

write.table(filtered_topTADsGenesDT, col.names=T, row.names=F, sep="\t", quote=F, file=outFile)

cat(paste0("... written: ", outFile, "\n"))

listFile <- file.path(outFolder, 
                     paste0(exprds, "_geneList_", paste0(all_hicds, collapse=""), "_", topThresh, ".txt"))
file.remove(listFile)

for(i in seq_along(all_topTADsGenes)) {
  txt <- paste0("\n> ", exprds, "\t", names(all_topTADsGenes)[i], ":\n")
  printAndLog(txt, logFile = listFile)
  tmpDT <- data.frame(all_topTADsGenes[i])
  tmpDT <- tmpDT[order(as.numeric(as.character(tmpDT[, grepl("\\.tad_rank", colnames(tmpDT))])), 
                       as.character(tmpDT[, grepl("\\.top_tads", colnames(tmpDT))]), as.character(tmpDT[, grepl("\\.symbol", colnames(tmpDT))])),]
  txt <- paste0(paste0(tmpDT[, grepl("\\.symbol", colnames(tmpDT))], collapse=","), "\n")
  printAndLog(txt, logFile = listFile)
  txt <- paste0(paste0(unique(as.character(tmpDT[, grepl("\\.top_tads", colnames(tmpDT))])), collapse=","), "\n")
  printAndLog(txt, logFile = listFile)
}

txt <- paste0("\n> ", exprds, "\t", "intersect", ":\n")
printAndLog(txt, logFile = listFile)
txt <- paste0(paste0(filtered_topTADsGenesDT$gene, collapse=","), "\n>")
printAndLog(txt, logFile = listFile)
######################################################################################
cat(paste0("... written: ", outFile, "\n"))
cat(paste0("... written: ", listFile, "\n"))
cat("*** DONE\n")
cat(paste0(startTime, "\n", Sys.time(), "\n"))

# resultDT <- data.frame(
#   # top_pvals = round(top_pvals, 4),
#   # top_pvals = top_pvals,
#   top_pvals = sprintf("%.2e",top_pvals),
#   top_tads = top_tads,
#   stringsAsFactors = FALSE
# )
# 
# cat(paste0("********** ", hicds, " - ", exprds, "\n\n"))
# cat(paste0("> topThresh\t=\t", topThresh, "\n"))
# cat(paste0("> pvalThresh\t=\t", sprintf("%.2e",pvalThresh), "\n\n"))
# cat(paste0("*** Top ranking TADs (adj. emp. p-val. combined): \n"))
# 
# #write.table(head(resultDT), col.names=TRUE, row.names=FALSE, sep="\t", quote=F, file = "")
# 
# write.table(resultDT, col.names=TRUE, row.names=FALSE, sep="\t", quote=F, file = "")









